<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Quest Trading Monitor (Beta)</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-json/2.6.0/jquery.json.min.js"></script>

    <script type="text/javascript">
        jQuery(function($) {

            function processEvents(events) {
            	// console.log("xxxxx events: " + events);
            	$('#logs').empty();
            	
            	// $('#logs').append('<span>' + events[0] + '</span><br/>');
            	
                if (events.length) {
                    // $('#logs').append('<span style="color: blue;">[Kdb] ' + events.length + ' events</span><br/>');
                } else {
                    // $('#logs').append('<span style="color: red;">[Kdb] no data</span><br/>');
                }
                
                for (var i in events) {
                    $('#logs').append('<span>' + events[i] + '</span><br/>');
                }
            }

            function long_polling() {
                $.getJSON('ajax', function(events) {
                    processEvents(events);
                    long_polling();
                });
            }

            long_polling();

        });
    </script>
</head>
<body>
<div id="logs" style="font-family: monospace;">
</div>
</body>
</html>
